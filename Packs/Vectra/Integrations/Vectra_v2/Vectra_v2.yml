category: Network Security
commonfields:
  id: Vectra v2
  version: -1
configuration:
- display: Server URL (e.g., https://192.168.0.1)
  name: server
  required: true
  type: 0
- display: API Token
  name: token
  required: true
  type: 4
- defaultvalue: 7 days
  display: First fetch time range (<number> <time unit>, e.g., 1 hour, 30 minutes)
  name: first_fetch
  required: false
  type: 0
- defaultvalue: '0'
  display: Fetch only Detections with greater/equal Certainty score
  name: c_score_gte
  required: false
  type: 0
- defaultvalue: '0'
  display: Fetch Detections with a threat score greater than or equal to
  name: t_score_gte
  required: false
  type: 0
- defaultvalue: all
  display: Fetch only Detections with matching State
  name: state
  options:
  - all
  - ignored
  - active
  - inactive
  required: false
  type: 15
- defaultvalue: '20'
  display: The number of results returned in each fetch
  name: max_fetch
  required: false
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Automated attacker behavior analytics
display: Vectra v2
name: Vectra v2
script:
  commands:
  - arguments:
    - default: false
      description: Filter by detection ID.
      isArray: false
      name: detection_id
      required: false
      secret: false
    - default: false
      description: Filters objects listed.
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Page number. Possible values are a positive integer or "last".
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Page size. Possible values are a positive integer or "all".
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: false
      description: Orders records by last timestamp, threat score, and certainty score.
        The default out sorts threat and certainty score in ascending order. Scores
        can be sorted in descending order by pre-pending the query with minus symbol
        (-).
      isArray: false
      name: ordering
      required: false
      secret: false
    - default: false
      description: Less than or equal to the specified ID.
      isArray: false
      name: min_id
      required: false
      secret: false
    - default: false
      description: Greater than or equal to the specified ID.
      isArray: false
      name: max_id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Filters by state ("active", "inactive", "ignored" - for all).
      isArray: false
      name: state
      predefined:
      - active
      - inactive
      - ignored
      - ignored for all
      required: false
      secret: false
    - default: false
      description: Filters by the detection type (verbose name).
      isArray: false
      name: type_vname
      required: false
      secret: false
    - default: false
      description: Filters. by the detection category.
      isArray: false
      name: category
      required: false
      secret: false
    - default: false
      description: Filters by the source (IP address).
      isArray: false
      name: src_ip
      required: false
      secret: false
    - default: false
      description: Filters by the threat score.
      isArray: false
      name: threat_score
      required: false
      secret: false
    - default: false
      description: Filters by the threat score that is greater than or equal to the
        score provided.
      isArray: false
      name: threat_score_gte
      required: false
      secret: false
    - default: false
      description: Filters by the certainty score.
      isArray: false
      name: certainty_score
      required: false
      secret: false
    - default: false
      description: Filters by the certainty score greater than or equal to the score
        provided.
      isArray: false
      name: certainty_score_gte
      required: false
      secret: false
    - default: false
      description: Filters by last timestamp.
      isArray: false
      name: last_timestamp
      required: false
      secret: false
    - default: false
      description: Filters by the ID of the host object to which a detection is attributed.
      isArray: false
      name: host_id
      required: false
      secret: false
    - default: false
      description: Filters by a comma-separated list tags.
      isArray: false
      name: tags
      required: false
      secret: false
    - default: false
      description: Filters by the destination in the detection detail set.
      isArray: false
      name: destination
      required: false
      secret: false
    - default: false
      description: Filters by the protocol in the detection detail set.
      isArray: false
      name: proto
      required: false
      secret: false
    - default: false
      description: Filters by the destination port in the detection detail set.
      isArray: false
      name: destination_port
      required: false
      secret: false
    - default: false
      description: Filters by the inbound_ip in the relayed comm set.
      isArray: false
      name: inbound_ip
      required: false
      secret: false
    - default: false
      description: Filters by the inbound_proto in the relayed comm set.
      isArray: false
      name: inbound_proto
      required: false
      secret: false
    - default: false
      description: Filters by the inbound_port in the relayed comm set.
      isArray: false
      name: inbound_port
      required: false
      secret: false
    - default: false
      description: Filters by the inbound_dns in the relayed comm set.
      isArray: false
      name: inbound_dns
      required: false
      secret: false
    - default: false
      description: Filters by the outbound_ip in the relayed comm set.
      isArray: false
      name: outbound_ip
      required: false
      secret: false
    - default: false
      description: Filters by the outbound_proto in the relayed comm set.
      isArray: false
      name: outbound_proto
      required: false
      secret: false
    - default: false
      description: Filters by the outbound_port in the relayed comm set.
      isArray: false
      name: outbound_port
      required: false
      secret: false
    - default: false
      description: Filters by the outbound_dns in the relayed comm set.
      isArray: false
      name: outbound_dns
      required: false
      secret: false
    - default: false
      description: Filters by the dns_ip in the dns set.
      isArray: false
      name: dns_ip
      required: false
      secret: false
    - default: false
      description: Filters by the dns_request in the dns set.
      isArray: false
      name: dns_request
      required: false
      secret: false
    - default: false
      description: Filters by the resp_code in the dns set.
      isArray: false
      name: resp_code
      required: false
      secret: false
    - default: false
      description: filter by the resp in the dns_set
      isArray: false
      name: resp
      required: false
      secret: false
    deprecated: false
    description: Returns a list of detection objects, which contain all the information
      related to security events detected on the network.
    execution: false
    name: vectra-get-detections
    outputs:
    - contextPath: Vectra.Detection.Category
      description: The category of the detected vname attack.
      type: String
    - contextPath: Vectra.Detection.TargetsKeyAsset
      description: Flag indicating if the host has a detection targeting a key asset.
      type: Boolean
    - contextPath: Vectra.Detection.CertaintyScore
      description: The current certainty score correlated to this host.
      type: Number
    - contextPath: Vectra.Detection.ID
      description: Object ID.
      type: Number
    - contextPath: Vectra.Detection.FirstTimestamp
      description: The timestamp when the event was first detected.
      type: String
    - contextPath: Vectra.Detection.LastTimestamp
      description: The timestamp when the event was last detected.
      type: String
    - contextPath: Vectra.Detection.State
      description: The state of the detection.
      type: String
    - contextPath: Vectra.Detection.Threat_Score
      description: The threat score attributed to the detection.
      type: Number
    - contextPath: Vectra.Detection.SourceIP
      description: The source IP address of the host attributed to the security event.
      type: String
    - contextPath: Vectra.Detection.SourceAccount
      description: A dictionary with fields that describe the Account from which the
        detection originates.
      type: Unknown
  - arguments:
    - default: false
      description: Filters by host ID.
      isArray: false
      name: host_id
      required: false
      secret: false
    - default: false
      description: Filters objects listed.
      isArray: false
      name: fields
      required: false
      secret: false
    - default: false
      description: Page number. Possible values are a positive integer or "last".
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Page size. Possible values are a positive integer or "all".
      isArray: false
      name: page_size
      required: false
      secret: false
    - default: false
      description: Orders records by last timestamp, threat score, and certainty score.
        The default out sorts threat and certainty score in ascending order. Scores
        can sorted in descending order by pre-pending the query with minus symbol
        (-).
      isArray: false
      name: ordering
      required: false
      secret: false
    - default: false
      description: Filters by name.
      isArray: false
      name: name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Filters by state ("active", "inactive", "suspended", "ignored",
        "ignored" - for all).
      isArray: false
      name: state
      predefined:
      - active
      - inactive
      - ignored
      - ignored for all
      required: false
      secret: false
    - default: false
      description: Filters by the last_source (IP address).
      isArray: false
      name: last_source
      required: false
      secret: false
    - default: false
      description: Filters by the threat score.
      isArray: false
      name: threat_score
      required: false
      secret: false
    - default: false
      description: Filters by the threat score, greater than or equal to the score
        provided.
      isArray: false
      name: threat_score_gte
      required: false
      secret: false
    - default: false
      description: filter by certainty score
      isArray: false
      name: certainty_score
      required: false
      secret: false
    - default: false
      description: Filters by the certainty score, greater than or equal to the score
        provided.
      isArray: false
      name: certainty_score_gte
      required: false
      secret: false
    - default: false
      description: Filters by the last_detection_timestamp.
      isArray: false
      name: last_detection_timestamp
      required: false
      secret: false
    - default: false
      description: Filters by a comma-separated list of tags. Returns hosts that contain
        any of the tags specified, e.g., tags=baz | tags=foo,bar.
      isArray: false
      name: tags
      required: false
      secret: false
    - default: false
      description: Filters by the key asset. Can be "True" or "False".
      isArray: false
      name: key_assest
      required: false
      secret: false
    - default: false
      description: Filters by the MAC address.
      isArray: false
      name: mac_address
      required: false
      secret: false
    deprecated: false
    description: Returns host information, which includes data that correlates the
      host data to detected security events.
    execution: false
    name: vectra-get-hosts
    outputs:
    - contextPath: Vectra.Host.Name
      description: The learned hostname.
      type: String
    - contextPath: Vectra.Host.TargetsKeyAsset
      description: Flag indicating if the host has a detection targeting a key asset.
      type: Boolean
    - contextPath: Vectra.Host.CertaintyScore
      description: The current certainty score correlated to this host.
      type: Number
    - contextPath: Vectra.Host.DetectionID
      description: List of Detections for Account.
      type: String
    - contextPath: Vectra.Host.KeyAsset
      description: Flag indicating if the host is a key asset
      type: Boolean
    - contextPath: Vectra.Host.State
      description: The state of this host.
      type: String
    - contextPath: Vectra.Host.Threat_Score
      description: The current threat score correlated to this host.
      type: Number
    - contextPath: Vectra.Host.LastDetection
      description: 'Last detection activity from this host (Timestamp format: YYYY-MM-DD
        HH-MM-SS GMT).'
      type: String
    - contextPath: Vectra.Host.IP
      description: Last source IP address associated with this host.
      type: String
    - contextPath: Vectra.Host.ID
      description: ID of the host.
      type: Number
  - deprecated: false
    description: The rules branch can be used to retrieve a listing of configured
      Triage rules
    execution: false
    name: vectra-triage
    outputs:
    - contextPath: Vectra.Rule.ID
      description: The record ID.
      type: Unknown
    - contextPath: Vectra.Rule.SmartCategory
      description: Custom Triage label used to re-categorize the specified detections.
      type: Unknown
    - contextPath: Vectra.Rule.Description
      description: Name of the Triage filter.
      type: Unknown
    - contextPath: Vectra.Rule.Type
      description: Original detection type.
      type: Unknown
    - contextPath: Vectra.Rule.Category
      description: Original detection category.
      type: Unknown
    - contextPath: Vectra.Rule.Created
      description: The timestamp when this Triage filter was created.
      type: Unknown
    - contextPath: Vectra.Rule.LastUpdate
      description: The timestamp when this Triage filter was triggered.
      type: Unknown
    - contextPath: Vectra.Rule.Host.ID
      description: The hosts to which this Triage filter applies.
      type: Unknown
    - contextPath: Vectra.Rule.IP
      description: Host IP address.
      type: Unknown
    - contextPath: Vectra.Rule.Priority
      description: Used in ordering execution of Triage filters.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.IP
      description: Destination IP address to where this Triage filter will be applied.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.Protocol
      description: Destination protocol to where this Triage filter will be applied.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.Port
      description: Destination port to where this Triage filter will be applied.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.DNS
      description: Destination FQDN to where this Triage filter will be applied.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.Kerberos.Account
      description: Kerberos Account.
      type: Unknown
    - contextPath: Vectra.Rule.Remote.Kerberos.Service
      description: Kerberos Service.
      type: Unknown
  - arguments:
    - default: true
      description: The ID of the required host. Can be retrieved from the vectra-get-hosts
        command.
      isArray: false
      name: host_id
      required: true
      secret: false
    deprecated: false
    description: Returns a host by ID.
    execution: false
    name: vectra-get-host-by-id
  - arguments:
    - default: true
      description: The ID of the required detection. Can be retrieve from the vectra-get-detections
        command.
      isArray: false
      name: detection_id
      required: true
      secret: false
    deprecated: false
    description: Returns detections by detection ID.
    execution: false
    name: vectra-get-detection-by-id
  - arguments:
    - default: false
      description: Filters by username.
      isArray: false
      name: username
      required: false
      secret: false
    - default: false
      description: Filters by role.
      isArray: false
      name: role
      required: false
      secret: false
    - default: false
      description: Filters by account type (Local, Special, Limited Time Link, LDAP,
        TACACS).
      isArray: false
      name: account_type
      required: false
      secret: false
    - default: false
      description: Filter by authentication profile (LDAP or TACACS only).
      isArray: false
      name: authentication_profile
      required: false
      secret: false
    - default: false
      description: Filters for users that have logged in since the given timestamp.
      isArray: false
      name: last_login_gte
      required: false
      secret: false
    deprecated: false
    description: Retrieves the current list of Users
    execution: false
    name: vectra-get-users
  - arguments:
    - default: false
      description: The ID of the Proxy object.
      isArray: false
      name: proxy_id
      required: false
      secret: false
    deprecated: false
    description: Retrieves the current list of proxy IP addresses, or single proxy
      IP address by proxy ID.
    execution: false
    name: vectra-get-proxies
    outputs:
    - contextPath: Vectra.Proxy.Source
      description: Whether the proxy was auto-detected by Cognito or was added by
        a user.
      type: String
    - contextPath: Vectra.Proxy.ID
      description: The ID of the Proxy.
      type: String
    - contextPath: Vectra.Proxy.Source
      description: Whether the proxy was auto-detected by Cognito or was added by
        a user.
      type: String
    - contextPath: Vectra.Proxy.ConsidersProxy
      description: Whether to consider the object as a proxy.
      type: String
    - contextPath: Vectra.Proxy.Address
      description: The proxy IP address.
      type: String
  - arguments:
    - default: false
      description: The ID of the ThreatFeed object.
      isArray: false
      name: threatfeed_id
      required: false
      secret: false
    deprecated: false
    description: Retrieves the current list of all ThreatFeeds, or single ThreatFeed
      by ThreatFeed ID.
    execution: false
    name: vectra-get-threatfeed
    outputs:
    - contextPath: Vectra.ThreatFeed.Category
      description: The category in which the detection will fire if a match is observed
        with any indicator in the ThreatFeed.
      type: String
    - contextPath: Vectra.ThreatFeed.Name
      description: The name of the ThreatFeed.
      type: String
    - contextPath: Vectra.ThreatFeed.Certainty
      description: The default certainty to use for indicators in the STIX file.
      type: String
    - contextPath: Vectra.ThreatFeed.IndicatorType
      description: The default indicatorType to use for the observables in the STIX
        file.
      type: String
    - contextPath: Vectra.ThreatFeed.Duration
      description: The default duration for which indicators in the ThreatFeed are
        valid.
      type: Number
    - contextPath: Vectra.ThreatFeed.ID
      description: The ID of the ThreatFeed.
      type: String
  - arguments:
    - default: false
      description: The query to perform, e.g., `host.threat:>=50 and host.certainty:>=50`
        will find all hosts in the critical quadrant. `host.owner_name:bob` will find
        hosts with probable owner that contains the phrase “bob” in it.
      isArray: false
      name: query_string
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The type of search to perform. Can be "Hosts" or "Detections".
      isArray: false
      name: search_type
      predefined:
      - hosts
      - detections
      required: true
      secret: false
    - default: false
      description: Number of results returned per page. The default page_size is 50,
        max. is 5000.
      isArray: false
      name: page_size
      required: false
      secret: false
    deprecated: false
    description: Runs an advanced search on hosts and detections.
    execution: false
    name: vectra-search
  dockerimage: demisto/python3:3.9.6.24019
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test
fromversion: 5.0.0
